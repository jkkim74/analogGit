<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.skplanet.bisportal.repository.bip.DssBmListRepository">

    <select id="getDssBmList" parameterType="long" resultType="DssBmList">
        SELECT
          ID,
          DSS_ID,
          BM_ID,
          CREATE_ID,
          CREATE_DATE,
          (SELECT NAME FROM MENU m WHERE DELETE_YN = 'N' AND m.ID = BM_ID) BM_NAME
        FROM
          DSS_BM_LIST
        WHERE
          DELETE_YN = 'N'
          AND DSS_ID = #{dssId}
    </select>

    <insert id="addDssBmList" parameterType="DssBmList">
        INSERT INTO DSS_BM_LIST (
            ID,
            DSS_ID,
            BM_ID,
            CREATE_ID,
            CREATE_DATE
            )
        VALUES (
            DSS_BM_LIST_SEQ.nextval,
            #{dssId},
            #{bmId},
            #{createId},
            to_char(sysdate,'YYYYMMDDHH24MISS')
            )
    </insert>

    <update id="deleteDssBmListByDssId" parameterType="java.util.Map">
        UPDATE DSS_BM_LIST
        SET
            DELETE_YN = 'Y',
            UPDATE_ID = #{updateId},
            UPDATE_DATE = to_char(sysdate,'YYYYMMDDHH24MISS')
        WHERE
            DELETE_YN = 'N'
            AND DSS_ID = #{dssId}
    </update>
</mapper>
