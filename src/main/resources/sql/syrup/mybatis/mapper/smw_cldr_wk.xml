<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.skplanet.bisportal.repository.syrup.SvcCdRepository">
    <select id="getWkStrdFrto" parameterType="SmwCldrWk" resultType="SmwCldrWk">
        SELECT STRD_YEAR
             , STRD_WK_SEQ
             , WK_ST_DT
             , WK_ED_DT
             , DISP_WK
          FROM SMW_CLDR_WK
         WHERE STRD_YEAR = SUBSTR(#{startDate}, 0, 4)
           AND #{startDate} BETWEEN WK_ST_DT AND WK_ED_DT
        UNION ALL
        SELECT '' STRD_YEAR
             , MAX(STRD_WK_SEQ)
             , '' WK_ST_DT
             , '' WK_ED_DT
             , '' DISP_WK
          FROM SMW_CLDR_WK
         WHERE STRD_YEAR = SUBSTR(#{startDate}, 0, 4)
        UNION ALL
        SELECT STRD_YEAR
             , STRD_WK_SEQ
             , WK_ST_DT
             , WK_ED_DT
             , DISP_WK
          FROM SMW_CLDR_WK
         WHERE STRD_YEAR = SUBSTR(#{endDate}, 0, 4)
           AND #{endDate} BETWEEN WK_ST_DT AND WK_ED_DT
        UNION ALL
        SELECT '' STRD_YEAR
               , MAX(STRD_WK_SEQ)
               , '' WK_ST_DT
               , '' WK_ED_DT
               , '' DISP_WK
        FROM SMW_CLDR_WK
        WHERE STRD_YEAR = SUBSTR(#{endDate}, 0, 4)
    </select>
    <select id="getWkStrd" parameterType="SmwCldrWk" resultType="SmwCldrWk">
        SELECT
               STRD_YEAR
             , STRD_WK_SEQ
             , DISP_WK
          FROM SMW_CLDR_WK
         WHERE STRD_YEAR = #{strdYear}
           AND (#{searchDate} BETWEEN WK_ST_DT AND WK_ED_DT)
    </select>
    <select id="getWkStrds" parameterType="SmwCldrWk" resultType="SmwCldrWk">
        SELECT
               STRD_YEAR
             , STRD_WK_SEQ
             , WK_ST_DT
             , WK_ED_DT
             , DISP_WK
        FROM SMW_CLDR_WK
        WHERE STRD_YEAR = #{strdYear}
    </select>
    <select id="getWeeks" parameterType="String" resultType="MstrWeek">
        SELECT WK_ST_DT || WK_ED_DT AS WK_PERD_CD
             , WK_ST_DT || '~' || WK_ED_DT AS WK_PERD_NM
             , WK_ST_DT
             , WK_ED_DT
             , STRD_YEAR || LPAD(STRD_WK_SEQ, 2, '0') AS WK_DT
          FROM SMW_CLDR_WK
         WHERE #{stnDate} BETWEEN WK_ST_DT AND WK_ED_DT
    </select>
</mapper>
