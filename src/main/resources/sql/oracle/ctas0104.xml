<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.skplanet.ctas.repository.oracle.OracleRepository">

	<select id="selectCell" parameterType="map" resultType="AutoMappedMap">
		<include refid="pagingHead" />

		<choose>
			<when test="cmpgnSndChnlFgCd == 'MAIL'">
				SELECT MBR_ID
					, EMAIL_ADDR
					, MBR_KOR_NM
					, AVL_PNT
					, AVL_PNT_BASE_DT
					, #{cellId} AS CELL_ID
					, UNITED_ID
					, NULL AS NOTHING
				FROM WEB_TRGT_${cellId}
			</when>
			<when test="cmpgnSndChnlFgCd == 'PUSH'">
				SELECT MBR_ID FROM WEB_TRGT_${cmpgnId}
			</when>
			<when test="cmpgnSndChnlFgCd == 'SMS'">
				SELECT MBR_ID
					, MBR_KOR_NM
					, CLPHN_NO
				FROM WEB_TRGT_${cellId}
			</when>
			<otherwise>
				SELECT #{cellId} AS CELL_ID FROM DUAL
			</otherwise>
		</choose>

		<include refid="pagingFoot" />
	</select>
	<select id="selectCell" parameterType="map" resultType="AutoMappedMap" databaseId="hsql">
		<choose>
			<when test="cmpgnSndChnlFgCd == 'MAIL'">
				SELECT MBR_ID
					, 'test@email.com' AS EMAIL_ADDR
					, '테스트' AS MBR_KOR_NM
					, '999' AS AVL_PNT
					, '20161130' AS AVL_PNT_BASE_DT
					, #{cellId} AS CELL_ID
					, 'ec_user_id' AS UNITED_ID
				FROM WEB_TRGT_${cmpgnId}
			</when>
			<when test="cmpgnSndChnlFgCd == 'PUSH'">
				SELECT MBR_ID FROM WEB_TRGT_${cmpgnId}
			</when>
			<when test="cmpgnSndChnlFgCd == 'SMS'">
				SELECT MBR_ID
					, '테스트' AS MBR_KOR_NM
					, '01012345678' AS CLPHN_NO
				FROM WEB_TRGT_${cmpgnId}
			</when>
			<otherwise>
				SELECT #{cellId} AS CELL_ID FROM DUAL
			</otherwise>
		</choose>

		<include refid="pagingFoot" />
	</select>

</mapper>
