<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.skplanet.pandora.repository.oracle.OracleRepository">

	<sql id="selectMembers_pan0101">
		<choose>
			<when test="uploadProgress.columnName == 'OCBCOM_LGN_ID'">
				SELECT NVL(A.MBR_ID,' ') MBR_ID
					, DECODE(B.LGN_ID,NULL,' ',SUBSTR(B.LGN_ID,1,LENGTH(B.LGN_ID)-2)||'**') AS OCBCOM_LGN_ID
					, NVL(A.CI_NO,' ') CI_NO
					, DECODE(A.MBR_KOR_NM,NULL,' ',SUBSTR(A.MBR_KOR_NM,1,LENGTH(A.MBR_KOR_NM)-2)||'*'||SUBSTR(A.MBR_KOR_NM,LENGTH(A.MBR_KOR_NM),1)) AS MBR_KOR_NM
					, DECODE(A.CARD_NO,NULL,' ',SUBSTR(A.CARD_NO,1,LENGTH(A.CARD_NO)-8)||'****'||SUBSTR(A.CARD_NO,LENGTH(A.CARD_NO)-3,4)) AS CARD_NO
					, NVL(A.SYW_MBR_ID,' ') SYW_MBR_ID
					, NVL(A.EVS_MBR_ID,' ') EVS_MBR_ID
				FROM MART_MBR_ID_MST A
				JOIN MART_OCBCOM_MBR_MST B ON A.MBR_ID = B.MBR_ID
				WHERE B.LGN_ID IN (SELECT COLUMN1 FROM TMP_${uploadProgress.pageId}_${uploadProgress.username})
			</when>
			<when test="uploadProgress.columnName == 'CARD_NO'">
				SELECT NVL(A.MBR_ID,' ') MBR_ID
				    , DECODE(A.OCBCOM_LGN_ID,NULL,' ',SUBSTR(A.OCBCOM_LGN_ID,1,LENGTH(A.OCBCOM_LGN_ID)-2)||'**') AS OCBCOM_LGN_ID
					, NVL(A.CI_NO,' ') CI_NO
					, DECODE(A.MBR_KOR_NM,NULL,' ',SUBSTR(A.MBR_KOR_NM,1,LENGTH(A.MBR_KOR_NM)-2)||'*'||SUBSTR(A.MBR_KOR_NM,LENGTH(A.MBR_KOR_NM),1)) AS MBR_KOR_NM
					, DECODE(B.CARD_NO,NULL,' ',SUBSTR(B.CARD_NO,1,LENGTH(B.CARD_NO)-8)||'****'||SUBSTR(B.CARD_NO,LENGTH(B.CARD_NO)-3,4)) AS CARD_NO
					, NVL(A.SYW_MBR_ID,' ') SYW_MBR_ID
					, NVL(A.EVS_MBR_ID,' ') EVS_MBR_ID
				FROM MART_MBR_ID_MST A
				JOIN MART_CARD_MST B ON A.MBR_ID = B.MBR_ID
				WHERE B.${uploadProgress.columnName} IN (SELECT COLUMN1 FROM TMP_${uploadProgress.pageId}_${uploadProgress.username})
			</when>
			<when test="uploadProgress.columnName == 'SYW_MBR_ID'">
				SELECT NVL(A.MBR_ID,' ') MBR_ID
					, DECODE(A.OCBCOM_LGN_ID,NULL,' ',SUBSTR(A.OCBCOM_LGN_ID,1,LENGTH(A.OCBCOM_LGN_ID)-2)||'**') AS OCBCOM_LGN_ID
					, NVL(A.CI_NO,' ') CI_NO
					, DECODE(A.MBR_KOR_NM,NULL,' ',SUBSTR(A.MBR_KOR_NM,1,LENGTH(A.MBR_KOR_NM)-2)||'*'||SUBSTR(A.MBR_KOR_NM,LENGTH(A.MBR_KOR_NM),1)) AS MBR_KOR_NM
					, DECODE(A.CARD_NO,NULL,' ',SUBSTR(A.CARD_NO,1,LENGTH(A.CARD_NO)-8)||'****'||SUBSTR(A.CARD_NO,LENGTH(A.CARD_NO)-3,4)) AS CARD_NO
					, NVL(B.SYW_MBR_ID,' ') SYW_MBR_ID
					, NVL(A.EVS_MBR_ID,' ') EVS_MBR_ID
				FROM MART_MBR_ID_MST A
				JOIN MART_SYW_MBR_ID_MST B ON A.MBR_ID = B.MBR_ID
				WHERE B.${uploadProgress.columnName} IN (SELECT COLUMN1 FROM TMP_${uploadProgress.pageId}_${uploadProgress.username})
			</when>
			<when test="uploadProgress.columnName == 'EVS_MBR_ID'">
				SELECT NVL(A.MBR_ID,' ') MBR_ID
					, DECODE(A.OCBCOM_LGN_ID,NULL,' ',SUBSTR(A.OCBCOM_LGN_ID,1,LENGTH(A.OCBCOM_LGN_ID)-2)||'**') AS OCBCOM_LGN_ID
					, NVL(A.CI_NO,' ') CI_NO
					, DECODE(A.MBR_KOR_NM,NULL,' ',SUBSTR(A.MBR_KOR_NM,1,LENGTH(A.MBR_KOR_NM)-2)||'*'||SUBSTR(A.MBR_KOR_NM,LENGTH(A.MBR_KOR_NM),1)) AS MBR_KOR_NM
					, DECODE(A.CARD_NO,NULL,' ',SUBSTR(A.CARD_NO,1,LENGTH(A.CARD_NO)-8)||'****'||SUBSTR(A.CARD_NO,LENGTH(A.CARD_NO)-3,4)) AS CARD_NO
					, NVL(A.SYW_MBR_ID,' ') SYW_MBR_ID
					, NVL(B.EVS_MBR_ID,' ') EVS_MBR_ID
				FROM MART_MBR_ID_MST A
				JOIN MART_EVS_MBR_ID_MST B ON A.MBR_ID = B.MBR_ID
				WHERE B.${uploadProgress.columnName} IN (SELECT COLUMN1 FROM TMP_${uploadProgress.pageId}_${uploadProgress.username})
			</when>
			<otherwise>
				SELECT NVL(MBR_ID,' ') MBR_ID
					, DECODE(OCBCOM_LGN_ID,NULL,' ',SUBSTR(OCBCOM_LGN_ID,1,LENGTH(OCBCOM_LGN_ID)-2)||'**') AS OCBCOM_LGN_ID
					, NVL(CI_NO,' ') CI_NO
					, DECODE(MBR_KOR_NM,NULL,' ',SUBSTR(MBR_KOR_NM,1,LENGTH(MBR_KOR_NM)-2)||'*'||SUBSTR(MBR_KOR_NM,LENGTH(MBR_KOR_NM),1)) AS MBR_KOR_NM
					, DECODE(CARD_NO,NULL,' ',SUBSTR(CARD_NO,1,LENGTH(CARD_NO)-8)||'****'||SUBSTR(CARD_NO,LENGTH(CARD_NO)-3,4)) AS CARD_NO
					, NVL(SYW_MBR_ID,' ') SYW_MBR_ID
					, NVL(EVS_MBR_ID,' ') EVS_MBR_ID
				FROM MART_MBR_ID_MST
				WHERE ${uploadProgress.columnName} IN (SELECT COLUMN1 FROM TMP_${uploadProgress.pageId}_${uploadProgress.username})
			</otherwise>
		</choose>
	</sql>
	
	<sql id="selectMembers_pan0101_nomas">
		<choose>
			<when test="uploadProgress.columnName == 'OCBCOM_LGN_ID'">
				SELECT NVL(A.MBR_ID,' ') MBR_ID
					, NVL(B.LGN_ID,' ') AS OCBCOM_LGN_ID
					, NVL(A.CI_NO,' ') CI_NO
					, NVL(A.MBR_KOR_NM,' ') AS MBR_KOR_NM
					, NVL(A.CARD_NO,' ') AS CARD_NO
					, NVL(A.SYW_MBR_ID,' ') SYW_MBR_ID
					, NVL(A.EVS_MBR_ID,' ') EVS_MBR_ID
				FROM MART_MBR_ID_MST A
				JOIN MART_OCBCOM_MBR_MST B ON A.MBR_ID = B.MBR_ID
				WHERE B.LGN_ID IN (SELECT COLUMN1 FROM TMP_${uploadProgress.pageId}_${uploadProgress.username})
			</when>
			<when test="uploadProgress.columnName == 'CARD_NO'">
				SELECT NVL(A.MBR_ID,' ') MBR_ID
				    , NVL(A.OCBCOM_LGN_ID,' ') AS OCBCOM_LGN_ID
					, NVL(A.CI_NO,' ') CI_NO
					, NVL(A.MBR_KOR_NM,' ') AS MBR_KOR_NM
					, NVL(B.CARD_NO,' ') AS CARD_NO
					, NVL(A.SYW_MBR_ID,' ') SYW_MBR_ID
					, NVL(A.EVS_MBR_ID,' ') EVS_MBR_ID
				FROM MART_MBR_ID_MST A
				JOIN MART_CARD_MST B ON A.MBR_ID = B.MBR_ID
				WHERE B.${uploadProgress.columnName} IN (SELECT COLUMN1 FROM TMP_${uploadProgress.pageId}_${uploadProgress.username})
			</when>
			<when test="uploadProgress.columnName == 'SYW_MBR_ID'">
				SELECT NVL(A.MBR_ID,' ') MBR_ID
					, NVL(A.OCBCOM_LGN_ID,' ') AS OCBCOM_LGN_ID
					, NVL(A.CI_NO,' ') CI_NO
					, NVL(A.MBR_KOR_NM,' ') AS MBR_KOR_NM
					, NVL(A.CARD_NO,' ') AS CARD_NO
					, NVL(B.SYW_MBR_ID,' ') SYW_MBR_ID
					, NVL(A.EVS_MBR_ID,' ') EVS_MBR_ID
				FROM MART_MBR_ID_MST A
				JOIN MART_SYW_MBR_ID_MST B ON A.MBR_ID = B.MBR_ID
				WHERE B.${uploadProgress.columnName} IN (SELECT COLUMN1 FROM TMP_${uploadProgress.pageId}_${uploadProgress.username})
			</when>
			<when test="uploadProgress.columnName == 'EVS_MBR_ID'">
				SELECT NVL(A.MBR_ID,' ') MBR_ID
					, NVL(A.OCBCOM_LGN_ID,' ') AS OCBCOM_LGN_ID
					, NVL(A.CI_NO,' ') CI_NO
					, NVL(A.MBR_KOR_NM,' ') AS MBR_KOR_NM
					, NVL(A.CARD_NO,' ') AS CARD_NO
					, NVL(A.SYW_MBR_ID,' ') SYW_MBR_ID
					, NVL(B.EVS_MBR_ID,' ') EVS_MBR_ID
				FROM MART_MBR_ID_MST A
				JOIN MART_EVS_MBR_ID_MST B ON A.MBR_ID = B.MBR_ID
				WHERE B.${uploadProgress.columnName} IN (SELECT COLUMN1 FROM TMP_${uploadProgress.pageId}_${uploadProgress.username})
			</when>
			<otherwise>
				SELECT NVL(MBR_ID,' ') MBR_ID
					, NVL(OCBCOM_LGN_ID,' ') AS OCBCOM_LGN_ID
					, NVL(CI_NO,' ') CI_NO
					, NVL(MBR_KOR_NM,' ') AS MBR_KOR_NM
					, NVL(CARD_NO,' ') AS CARD_NO
					, NVL(SYW_MBR_ID,' ') SYW_MBR_ID
					, NVL(EVS_MBR_ID,' ') EVS_MBR_ID
				FROM MART_MBR_ID_MST
				WHERE ${uploadProgress.columnName} IN (SELECT COLUMN1 FROM TMP_${uploadProgress.pageId}_${uploadProgress.username})
			</otherwise>
		</choose>
	</sql>	

</mapper>
