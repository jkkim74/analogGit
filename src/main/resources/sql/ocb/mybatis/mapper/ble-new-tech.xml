<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.skplanet.bisportal.repository.ocb.BleNewTechRepository">
    <sql id="selectDayMid">
        WITH CAMPAIGN AS (
            SELECT distinct B.MID, NAME1||' '||NAME2 as NAME1
            FROM    BLE_D_INTG_STA B, ISTUSER.BLE_CAMPAIGN_INFO C, ISTUSER.IMC_M_MERCH_BASIC M
            WHERE   B.STD_DT BETWEEN #{startDate} AND #{endDate}
            AND     B.MID = C.MID(+)
            AND     B.MID = M.MID(+)
            <if test="searchString != null and searchString != '' and itemCode == 1">
                AND C.CAMPAIGN_ID = #{searchString}
            </if>
            <if test="searchString != null and searchString != '' and itemCode == 2">
                AND M.NAME1 = #{searchString}
            </if>
            <if test="searchString != null and searchString != '' and itemCode == 3">
                AND B.MID = #{searchString}
            </if>
            <if test="searchString != null and searchString != '' and itemCode == 4">
                AND C.BID = #{searchString}
            </if>
        )
    </sql>
    <sql id="selectWeekMid">
        WITH CAMPAIGN AS (
        SELECT distinct B.MID, NAME1||' '||NAME2 as NAME1
        FROM    BLE_W_INTG_STA B, ISTUSER.BLE_CAMPAIGN_INFO C, ISTUSER.IMC_M_MERCH_BASIC M
        WHERE   B.STD_YM||B.WK_CD BETWEEN #{startDate} AND #{endDate}
        AND     B.MID = C.MID(+)
        AND     B.MID = M.MID(+)
        <if test="searchString != null and searchString != '' and itemCode == 1">
            AND C.CAMPAIGN_ID = #{searchString}
        </if>
        <if test="searchString != null and searchString != '' and itemCode == 2">
            AND M.NAME1 = #{searchString}
        </if>
        <if test="searchString != null and searchString != '' and itemCode == 3">
            AND B.MID = #{searchString}
        </if>
        <if test="searchString != null and searchString != '' and itemCode == 4">
            AND C.BID = #{searchString}
        </if>
        )
    </sql>
    <sql id="selectMonthMid">
        WITH CAMPAIGN AS (
        SELECT distinct B.MID, NAME1||' '||NAME2 as NAME1
        FROM    BLE_M_INTG_STA B, ISTUSER.BLE_CAMPAIGN_INFO C, ISTUSER.IMC_M_MERCH_BASIC M
        WHERE   B.STD_YM BETWEEN #{startDate} AND #{endDate}
        AND     B.MID = C.MID(+)
        AND     B.MID = M.MID(+)
        <if test="searchString != null and searchString != '' and itemCode == 1">
            AND C.CAMPAIGN_ID = #{searchString}
        </if>
        <if test="searchString != null and searchString != '' and itemCode == 2">
            AND M.NAME1 = #{searchString}
        </if>
        <if test="searchString != null and searchString != '' and itemCode == 3">
            AND B.MID = #{searchString}
        </if>
        <if test="searchString != null and searchString != '' and itemCode == 4">
            AND C.BID = #{searchString}
        </if>
        )
    </sql>
    <select id="getMerchantDetail" parameterType="JqGridRequest" resultType="BleNewTech">
        SELECT M.name1, M.mid, C.campaign_id, C.bid
        FROM   ISTUSER.IMC_M_MERCH_BASIC M, ISTUSER.BLE_CAMPAIGN_INFO C
        WHERE  M.mid = C.mid
        AND    M.MID = #{searchString}
    </select>
    <select id="getWeekNumberOfMonth" parameterType="JqGridRequest" resultType="ComStdDt">
        SELECT std_dt, std_yy, std_ym, wk_cd, day_ind_cd, std_ym||wk_cd as stdYmWkCd
        FROM   COMUSER.COM_STD_DT
        WHERE  std_dt = #{startDate}
        UNION ALL
        SELECT std_dt, std_yy, std_ym, wk_cd, day_ind_cd, std_ym||wk_cd as stdYmWkCd
        FROM   COMUSER.COM_STD_DT
        WHERE  std_dt = #{endDate}
    </select>
    <select id="getNewTechBySumTotal" parameterType="JqGridRequest" resultType="BleNewTech">
        <include refid="selectDayMid" />
        SELECT totalRecordCount, STD_DT, NAME1, MID, OCB_SRP_PV, OCB_SRP_UV, OCB_COIN_PV, OCB_COIN_UV, OCB_LEAFLET_PV, OCB_LEAFLET_UV, SRP_PUSH_POP_PV,
        SRP_PUSH_POP_UV, SRP_PUSH_NOTI_PV, SRP_PUSH_NOTI_UV, SRP_ICON_BTN_PV, SRP_ICON_BTN_UV,
        OCB_MLF_CLK_PV, OCB_MLF_CLK_UV, OCB_CHKIN_CLK_PV, OCB_CHKIN_CLK_UV, SRP_OK_CLK_PV, SRP_OK_CLK_UV,
        SRP_CNCL_CLK_PV, SRP_CNCL_CLK_UV, SRP_ICON_BTN_CLK_PV, SRP_ICON_BTN_CLK_UV, SRP_ICON_PV, SRP_ICON_UV,
        OCB_MLF_READ_PV, OCB_MLF_READ_UV, OCB_CHKIN_READ_PV, OCB_CHKIN_READ_UV, SRP_OK_READ_PV, SRP_OK_READ_UV, rnum
        FROM (
            SELECT totalRecordCount, STD_DT, NAME1, MID, OCB_SRP_PV, OCB_SRP_UV, OCB_COIN_PV, OCB_COIN_UV, OCB_LEAFLET_PV, OCB_LEAFLET_UV, SRP_PUSH_POP_PV,
            SRP_PUSH_POP_UV, SRP_PUSH_NOTI_PV, SRP_PUSH_NOTI_UV, SRP_ICON_BTN_PV, SRP_ICON_BTN_UV,
            OCB_MLF_CLK_PV, OCB_MLF_CLK_UV, OCB_CHKIN_CLK_PV, OCB_CHKIN_CLK_UV, SRP_OK_CLK_PV, SRP_OK_CLK_UV,
            SRP_CNCL_CLK_PV, SRP_CNCL_CLK_UV, SRP_ICON_BTN_CLK_PV, SRP_ICON_BTN_CLK_UV, SRP_ICON_PV, SRP_ICON_UV,
            OCB_MLF_READ_PV, OCB_MLF_READ_UV, OCB_CHKIN_READ_PV, OCB_CHKIN_READ_UV, SRP_OK_READ_PV, SRP_OK_READ_UV, rownum rnum
            FROM (
                SELECT /*+ ORDERED INDEX(BLE_D_INTG_STA BLE_D_INTG_STA_NEW_PK) */ COUNT(*) OVER() totalRecordCount, TO_CHAR(TO_DATE(#{startDate}, 'YYYYMMDD'),'YYYY-MM-DD')||'~'||TO_CHAR(TO_DATE(#{endDate}, 'YYYYMMDD'),'YYYY-MM-DD') AS STD_DT, C.NAME1, B.MID, SUM(OCB_SRP_PV) as OCB_SRP_PV, SUM(OCB_SRP_UV) as OCB_SRP_UV,
                    SUM(OCB_COIN_PV) as OCB_COIN_PV, SUM(OCB_COIN_UV) as OCB_COIN_UV, SUM(OCB_LEAFLET_PV) as OCB_LEAFLET_PV, SUM(OCB_LEAFLET_UV) as OCB_LEAFLET_UV, SUM(SRP_PUSH_POP_PV) as SRP_PUSH_POP_PV, SUM(SRP_PUSH_POP_UV) as SRP_PUSH_POP_UV, SUM(SRP_PUSH_NOTI_PV) as SRP_PUSH_NOTI_PV,
                    SUM(SRP_PUSH_NOTI_UV) as SRP_PUSH_NOTI_UV, SUM(SRP_ICON_BTN_PV) as SRP_ICON_BTN_PV, SUM(SRP_ICON_BTN_UV) as SRP_ICON_BTN_UV,
                    SUM(OCB_MLF_CLK_PV) as OCB_MLF_CLK_PV, SUM(OCB_MLF_CLK_UV) as OCB_MLF_CLK_UV, SUM(OCB_CHKIN_CLK_PV) as OCB_CHKIN_CLK_PV, SUM(OCB_CHKIN_CLK_UV) as OCB_CHKIN_CLK_UV, SUM(SRP_OK_CLK_PV) as SRP_OK_CLK_PV,
                    SUM(SRP_OK_CLK_UV) as SRP_OK_CLK_UV, SUM(SRP_CNCL_CLK_PV) as SRP_CNCL_CLK_PV, SUM(SRP_CNCL_CLK_UV) as SRP_CNCL_CLK_UV, SUM(SRP_ICON_BTN_CLK_PV) as SRP_ICON_BTN_CLK_PV,
                    SUM(SRP_ICON_BTN_CLK_UV) as SRP_ICON_BTN_CLK_UV, SUM(SRP_ICON_PV) as SRP_ICON_PV, SUM(SRP_ICON_UV) as SRP_ICON_UV,
                    SUM(OCB_MLF_READ_PV) as OCB_MLF_READ_PV, SUM(OCB_MLF_READ_UV) as OCB_MLF_READ_UV, SUM(OCB_CHKIN_READ_PV) as OCB_CHKIN_READ_PV, SUM(OCB_CHKIN_READ_UV) as OCB_CHKIN_READ_UV, SUM(SRP_OK_READ_PV) as SRP_OK_READ_PV,
                    SUM(SRP_OK_READ_UV) as SRP_OK_READ_UV
                FROM  CAMPAIGN C, BLE_D_INTG_STA B
                WHERE C.MID = B.MID
                AND   B.STD_DT BETWEEN #{startDate} AND #{endDate}
                GROUP BY TO_CHAR(TO_DATE(#{startDate}, 'YYYYMMDD'),'YYYY-MM-DD')||'~'||TO_CHAR(TO_DATE(#{endDate}, 'YYYYMMDD'),'YYYY-MM-DD'), C.NAME1, B.MID
                ORDER BY C.NAME1
            ) WHERE rownum &lt;= #{lastIndex}
        ) WHERE rnum > #{firstIndex}
    </select>
    <select id="getNewTechBySumTotalForExcel" parameterType="JqGridRequest" resultType="BleNewTech">
        <include refid="selectDayMid" />
        SELECT /*+ ORDERED INDEX(BLE_D_INTG_STA BLE_D_INTG_STA_NEW_PK) */ TO_CHAR(TO_DATE(#{startDate}, 'YYYYMMDD'),'YYYY-MM-DD')||'~'||TO_CHAR(TO_DATE(#{endDate}, 'YYYYMMDD'),'YYYY-MM-DD') AS STD_DT, C.NAME1, B.MID, SUM(OCB_SRP_PV) as OCB_SRP_PV, SUM(OCB_SRP_UV) as OCB_SRP_UV,
            SUM(OCB_COIN_PV) as OCB_COIN_PV, SUM(OCB_COIN_UV) as OCB_COIN_UV, SUM(OCB_LEAFLET_PV) as OCB_LEAFLET_PV, SUM(OCB_LEAFLET_UV) as OCB_LEAFLET_UV, SUM(SRP_PUSH_POP_PV) as SRP_PUSH_POP_PV, SUM(SRP_PUSH_POP_UV) as SRP_PUSH_POP_UV, SUM(SRP_PUSH_NOTI_PV) as SRP_PUSH_NOTI_PV,
            SUM(SRP_PUSH_NOTI_UV) as SRP_PUSH_NOTI_UV, SUM(SRP_ICON_BTN_PV) as SRP_ICON_BTN_PV, SUM(SRP_ICON_BTN_UV) as SRP_ICON_BTN_UV,
            SUM(OCB_MLF_CLK_PV) as OCB_MLF_CLK_PV, SUM(OCB_MLF_CLK_UV) as OCB_MLF_CLK_UV, SUM(OCB_CHKIN_CLK_PV) as OCB_CHKIN_CLK_PV, SUM(OCB_CHKIN_CLK_UV) as OCB_CHKIN_CLK_UV, SUM(SRP_OK_CLK_PV) as SRP_OK_CLK_PV,
            SUM(SRP_OK_CLK_UV) as SRP_OK_CLK_UV, SUM(SRP_CNCL_CLK_PV) as SRP_CNCL_CLK_PV, SUM(SRP_CNCL_CLK_UV) as SRP_CNCL_CLK_UV, SUM(SRP_ICON_BTN_CLK_PV) as SRP_ICON_BTN_CLK_PV,
            SUM(SRP_ICON_BTN_CLK_UV) as SRP_ICON_BTN_CLK_UV, SUM(SRP_ICON_PV) as SRP_ICON_PV, SUM(SRP_ICON_UV) as SRP_ICON_UV,
            SUM(OCB_MLF_READ_PV) as OCB_MLF_READ_PV, SUM(OCB_MLF_READ_UV) as OCB_MLF_READ_UV, SUM(OCB_CHKIN_READ_PV) as OCB_CHKIN_READ_PV, SUM(OCB_CHKIN_READ_UV) as OCB_CHKIN_READ_UV, SUM(SRP_OK_READ_PV) as SRP_OK_READ_PV,
            SUM(SRP_OK_READ_UV) as SRP_OK_READ_UV
        FROM  CAMPAIGN C, BLE_D_INTG_STA B
        WHERE C.MID = B.MID
        AND   B.STD_DT BETWEEN #{startDate} AND #{endDate}
        GROUP BY TO_CHAR(TO_DATE(#{startDate}, 'YYYYMMDD'),'YYYY-MM-DD')||'~'||TO_CHAR(TO_DATE(#{endDate}, 'YYYYMMDD'),'YYYY-MM-DD'), C.NAME1, B.MID
        ORDER BY C.NAME1
    </select>
    <select id="getNewTechByDailyTotal" parameterType="JqGridRequest" resultType="BleNewTech">
        <include refid="selectDayMid" />
        SELECT totalRecordCount, STD_DT, NAME1, MID, OCB_SRP_PV, OCB_SRP_UV, OCB_COIN_PV, OCB_COIN_UV, OCB_LEAFLET_PV, OCB_LEAFLET_UV, SRP_PUSH_POP_PV,
            SRP_PUSH_POP_UV, SRP_PUSH_NOTI_PV, SRP_PUSH_NOTI_UV, SRP_ICON_BTN_PV, SRP_ICON_BTN_UV,
            OCB_MLF_CLK_PV, OCB_MLF_CLK_UV, OCB_CHKIN_CLK_PV, OCB_CHKIN_CLK_UV, SRP_OK_CLK_PV, SRP_OK_CLK_UV,
            SRP_CNCL_CLK_PV, SRP_CNCL_CLK_UV, SRP_ICON_BTN_CLK_PV, SRP_ICON_BTN_CLK_UV, SRP_ICON_PV, SRP_ICON_UV,
            OCB_MLF_READ_PV, OCB_MLF_READ_UV, OCB_CHKIN_READ_PV, OCB_CHKIN_READ_UV, SRP_OK_READ_PV, SRP_OK_READ_UV, rnum
        FROM (
            SELECT totalRecordCount, STD_DT, NAME1, MID, OCB_SRP_PV, OCB_SRP_UV, OCB_COIN_PV, OCB_COIN_UV, OCB_LEAFLET_PV, OCB_LEAFLET_UV, SRP_PUSH_POP_PV,
                SRP_PUSH_POP_UV, SRP_PUSH_NOTI_PV, SRP_PUSH_NOTI_UV, SRP_ICON_BTN_PV, SRP_ICON_BTN_UV,
                OCB_MLF_CLK_PV, OCB_MLF_CLK_UV, OCB_CHKIN_CLK_PV, OCB_CHKIN_CLK_UV, SRP_OK_CLK_PV, SRP_OK_CLK_UV,
                SRP_CNCL_CLK_PV, SRP_CNCL_CLK_UV, SRP_ICON_BTN_CLK_PV, SRP_ICON_BTN_CLK_UV, SRP_ICON_PV, SRP_ICON_UV,
                OCB_MLF_READ_PV, OCB_MLF_READ_UV, OCB_CHKIN_READ_PV, OCB_CHKIN_READ_UV, SRP_OK_READ_PV, SRP_OK_READ_UV, rownum rnum
            FROM (
                SELECT /*+ ORDERED INDEX(BLE_D_INTG_STA BLE_D_INTG_STA_NEW_PK) */ COUNT(*) OVER() totalRecordCount, TO_CHAR(TO_DATE(B.STD_DT, 'YYYYMMDD'),'YYYY-MM-DD')||'('|| TO_CHAR(TO_DATE(B.STD_DT, 'yyyymmdd'), 'dy')|| ')' AS STD_DT, C.NAME1, B.MID, OCB_SRP_PV, OCB_SRP_UV,
                    OCB_COIN_PV, OCB_COIN_UV, OCB_LEAFLET_PV, OCB_LEAFLET_UV, SRP_PUSH_POP_PV, SRP_PUSH_POP_UV, SRP_PUSH_NOTI_PV, SRP_PUSH_NOTI_UV, SRP_ICON_BTN_PV, SRP_ICON_BTN_UV,
                    OCB_MLF_CLK_PV, OCB_MLF_CLK_UV, OCB_CHKIN_CLK_PV, OCB_CHKIN_CLK_UV, SRP_OK_CLK_PV, SRP_OK_CLK_UV, SRP_CNCL_CLK_PV, SRP_CNCL_CLK_UV, SRP_ICON_BTN_CLK_PV, SRP_ICON_BTN_CLK_UV, SRP_ICON_PV, SRP_ICON_UV,
                    OCB_MLF_READ_PV, OCB_MLF_READ_UV, OCB_CHKIN_READ_PV, OCB_CHKIN_READ_UV, SRP_OK_READ_PV, SRP_OK_READ_UV
                FROM CAMPAIGN C, BLE_D_INTG_STA B
                WHERE C.MID = B.MID
                AND   B.STD_DT BETWEEN #{startDate} AND #{endDate}
                ORDER BY STD_DT, C.NAME1
          ) WHERE rownum &lt;= #{lastIndex}
        ) WHERE rnum > #{firstIndex}
    </select>
    <select id="getNewTechByDailyTotalForExcel" parameterType="JqGridRequest" resultType="BleNewTech">
        <include refid="selectDayMid" />
        SELECT /*+ ORDERED INDEX(BLE_D_INTG_STA BLE_D_INTG_STA_NEW_PK) */ TO_CHAR(TO_DATE(B.STD_DT, 'YYYYMMDD'),'YYYY-MM-DD')||'('|| TO_CHAR(TO_DATE(B.STD_DT, 'yyyymmdd'), 'dy')|| ')' AS STD_DT, C.NAME1, B.MID, OCB_SRP_PV, OCB_SRP_UV,
            OCB_COIN_PV, OCB_COIN_UV, OCB_LEAFLET_PV, OCB_LEAFLET_UV, SRP_PUSH_POP_PV, SRP_PUSH_POP_UV, SRP_PUSH_NOTI_PV, SRP_PUSH_NOTI_UV, SRP_ICON_BTN_PV, SRP_ICON_BTN_UV,
            OCB_MLF_CLK_PV, OCB_MLF_CLK_UV, OCB_CHKIN_CLK_PV, OCB_CHKIN_CLK_UV, SRP_OK_CLK_PV, SRP_OK_CLK_UV, SRP_CNCL_CLK_PV, SRP_CNCL_CLK_UV, SRP_ICON_BTN_CLK_PV, SRP_ICON_BTN_CLK_UV, SRP_ICON_PV, SRP_ICON_UV,
            OCB_MLF_READ_PV, OCB_MLF_READ_UV, OCB_CHKIN_READ_PV, OCB_CHKIN_READ_UV, SRP_OK_READ_PV, SRP_OK_READ_UV
        FROM  CAMPAIGN C, BLE_D_INTG_STA B
        WHERE C.MID = B.MID
        AND   B.STD_DT BETWEEN #{startDate} AND #{endDate}
        ORDER BY STD_DT, C.NAME1
    </select>
    <select id="getNewTechByWeeklyTotal" parameterType="JqGridRequest" resultType="BleNewTech">
        <include refid="selectWeekMid" />
        SELECT totalRecordCount, STD_DT, NAME1, MID, OCB_SRP_PV, OCB_SRP_UV, OCB_COIN_PV, OCB_COIN_UV, OCB_LEAFLET_PV, OCB_LEAFLET_UV, SRP_PUSH_POP_PV,
            SRP_PUSH_POP_UV, SRP_PUSH_NOTI_PV, SRP_PUSH_NOTI_UV, SRP_ICON_BTN_PV, SRP_ICON_BTN_UV,
            OCB_MLF_CLK_PV, OCB_MLF_CLK_UV, OCB_CHKIN_CLK_PV, OCB_CHKIN_CLK_UV, SRP_OK_CLK_PV, SRP_OK_CLK_UV,
            SRP_CNCL_CLK_PV, SRP_CNCL_CLK_UV, SRP_ICON_BTN_CLK_PV, SRP_ICON_BTN_CLK_UV, SRP_ICON_PV, SRP_ICON_UV,
            OCB_MLF_READ_PV, OCB_MLF_READ_UV, OCB_CHKIN_READ_PV, OCB_CHKIN_READ_UV, SRP_OK_READ_PV, SRP_OK_READ_UV, rnum
        FROM (
            SELECT totalRecordCount, STD_DT, NAME1, MID, OCB_SRP_PV, OCB_SRP_UV, OCB_COIN_PV, OCB_COIN_UV, OCB_LEAFLET_PV, OCB_LEAFLET_UV, SRP_PUSH_POP_PV,
                SRP_PUSH_POP_UV, SRP_PUSH_NOTI_PV, SRP_PUSH_NOTI_UV, SRP_ICON_BTN_PV, SRP_ICON_BTN_UV,
                OCB_MLF_CLK_PV, OCB_MLF_CLK_UV, OCB_CHKIN_CLK_PV, OCB_CHKIN_CLK_UV, SRP_OK_CLK_PV, SRP_OK_CLK_UV,
                SRP_CNCL_CLK_PV, SRP_CNCL_CLK_UV, SRP_ICON_BTN_CLK_PV, SRP_ICON_BTN_CLK_UV, SRP_ICON_PV, SRP_ICON_UV,
                OCB_MLF_READ_PV, OCB_MLF_READ_UV, OCB_CHKIN_READ_PV, OCB_CHKIN_READ_UV, SRP_OK_READ_PV, SRP_OK_READ_UV, rownum rnum
            FROM (
                SELECT /*+ ORDERED INDEX(BLE_W_INTG_STA BLE_W_INTG_STA_NEW_PK) */ COUNT(*) OVER() totalRecordCount, B.STD_YM||'-'||B.WK_CD||'주차('||W.WK_DESC||')' AS STD_DT, C.NAME1, B.MID, OCB_SRP_PV, OCB_SRP_UV,
                    OCB_COIN_PV, OCB_COIN_UV, OCB_LEAFLET_PV, OCB_LEAFLET_UV, SRP_PUSH_POP_PV, SRP_PUSH_POP_UV, SRP_PUSH_NOTI_PV, SRP_PUSH_NOTI_UV, SRP_ICON_BTN_PV, SRP_ICON_BTN_UV,
                    OCB_MLF_CLK_PV, OCB_MLF_CLK_UV, OCB_CHKIN_CLK_PV, OCB_CHKIN_CLK_UV, SRP_OK_CLK_PV, SRP_OK_CLK_UV, SRP_CNCL_CLK_PV, SRP_CNCL_CLK_UV, SRP_ICON_BTN_CLK_PV, SRP_ICON_BTN_CLK_UV, SRP_ICON_PV, SRP_ICON_UV,
                    OCB_MLF_READ_PV, OCB_MLF_READ_UV, OCB_CHKIN_READ_PV, OCB_CHKIN_READ_UV, SRP_OK_READ_PV, SRP_OK_READ_UV
                FROM  CAMPAIGN C, COMUSER.COM_STD_WK W, BLE_W_INTG_STA B
                WHERE C.MID = B.MID
                AND   W.STD_YM = B.STD_YM
                AND   W.WK_CD = B.WK_CD
                AND   B.STD_YM||B.WK_CD BETWEEN #{startDate} AND #{endDate}
                ORDER BY STD_DT, C.NAME1
            ) WHERE rownum &lt;= #{lastIndex}
        ) WHERE rnum > #{firstIndex}
    </select>
    <select id="getNewTechByWeeklyTotalForExcel" parameterType="JqGridRequest" resultType="BleNewTech">
        <include refid="selectWeekMid" />
        SELECT /*+ ORDERED INDEX(BLE_W_INTG_STA BLE_W_INTG_STA_NEW_PK) */ B.STD_YM||'-'||B.WK_CD||'주차('||W.WK_DESC||')' AS STD_DT, C.NAME1, B.MID, OCB_SRP_PV, OCB_SRP_UV,
            OCB_COIN_PV, OCB_COIN_UV, OCB_LEAFLET_PV, OCB_LEAFLET_UV, SRP_PUSH_POP_PV, SRP_PUSH_POP_UV, SRP_PUSH_NOTI_PV, SRP_PUSH_NOTI_UV, SRP_ICON_BTN_PV, SRP_ICON_BTN_UV,
            OCB_MLF_CLK_PV, OCB_MLF_CLK_UV, OCB_CHKIN_CLK_PV, OCB_CHKIN_CLK_UV, SRP_OK_CLK_PV, SRP_OK_CLK_UV, SRP_CNCL_CLK_PV, SRP_CNCL_CLK_UV, SRP_ICON_BTN_CLK_PV, SRP_ICON_BTN_CLK_UV, SRP_ICON_PV, SRP_ICON_UV,
            OCB_MLF_READ_PV, OCB_MLF_READ_UV, OCB_CHKIN_READ_PV, OCB_CHKIN_READ_UV, SRP_OK_READ_PV, SRP_OK_READ_UV
        FROM  CAMPAIGN C, COMUSER.COM_STD_WK W, BLE_W_INTG_STA B
        WHERE C.MID = B.MID
        AND   W.STD_YM = B.STD_YM
        AND   W.WK_CD = B.WK_CD
        AND   B.STD_YM||B.WK_CD BETWEEN #{startDate} AND #{endDate}
        ORDER BY STD_DT, C.NAME1
    </select>
    <select id="getNewTechByMonthlyTotal" parameterType="JqGridRequest" resultType="BleNewTech">
        <include refid="selectMonthMid" />
        SELECT totalRecordCount, STD_DT, NAME1, MID, OCB_SRP_PV, OCB_SRP_UV, OCB_COIN_PV, OCB_COIN_UV, OCB_LEAFLET_PV, OCB_LEAFLET_UV, SRP_PUSH_POP_PV,
            SRP_PUSH_POP_UV, SRP_PUSH_NOTI_PV, SRP_PUSH_NOTI_UV, SRP_ICON_BTN_PV, SRP_ICON_BTN_UV,
            OCB_MLF_CLK_PV, OCB_MLF_CLK_UV, OCB_CHKIN_CLK_PV, OCB_CHKIN_CLK_UV, SRP_OK_CLK_PV, SRP_OK_CLK_UV,
            SRP_CNCL_CLK_PV, SRP_CNCL_CLK_UV, SRP_ICON_BTN_CLK_PV, SRP_ICON_BTN_CLK_UV, SRP_ICON_PV, SRP_ICON_UV,
            OCB_MLF_READ_PV, OCB_MLF_READ_UV, OCB_CHKIN_READ_PV, OCB_CHKIN_READ_UV, SRP_OK_READ_PV, SRP_OK_READ_UV, rnum
        FROM (
            SELECT totalRecordCount, STD_DT, NAME1, MID, OCB_SRP_PV, OCB_SRP_UV, OCB_COIN_PV, OCB_COIN_UV, OCB_LEAFLET_PV, OCB_LEAFLET_UV, SRP_PUSH_POP_PV,
                SRP_PUSH_POP_UV, SRP_PUSH_NOTI_PV, SRP_PUSH_NOTI_UV, SRP_ICON_BTN_PV, SRP_ICON_BTN_UV,
                OCB_MLF_CLK_PV, OCB_MLF_CLK_UV, OCB_CHKIN_CLK_PV, OCB_CHKIN_CLK_UV, SRP_OK_CLK_PV, SRP_OK_CLK_UV,
                SRP_CNCL_CLK_PV, SRP_CNCL_CLK_UV, SRP_ICON_BTN_CLK_PV, SRP_ICON_BTN_CLK_UV, SRP_ICON_PV, SRP_ICON_UV,
                OCB_MLF_READ_PV, OCB_MLF_READ_UV, OCB_CHKIN_READ_PV, OCB_CHKIN_READ_UV, SRP_OK_READ_PV, SRP_OK_READ_UV, rownum rnum
            FROM (
                SELECT /*+ ORDERED INDEX(BLE_M_INTG_STA BLE_M_INTG_STA_NEW_PK) */ COUNT(*) OVER() totalRecordCount, TO_CHAR(TO_DATE(B.STD_YM,'YYYYMM'),'YYYY-MM') AS STD_DT, C.NAME1, B.MID, OCB_SRP_PV, OCB_SRP_UV,
                    OCB_COIN_PV, OCB_COIN_UV, OCB_LEAFLET_PV, OCB_LEAFLET_UV, SRP_PUSH_POP_PV, SRP_PUSH_POP_UV, SRP_PUSH_NOTI_PV, SRP_PUSH_NOTI_UV, SRP_ICON_BTN_PV, SRP_ICON_BTN_UV,
                    OCB_MLF_CLK_PV, OCB_MLF_CLK_UV, OCB_CHKIN_CLK_PV, OCB_CHKIN_CLK_UV, SRP_OK_CLK_PV, SRP_OK_CLK_UV, SRP_CNCL_CLK_PV, SRP_CNCL_CLK_UV, SRP_ICON_BTN_CLK_PV, SRP_ICON_BTN_CLK_UV, SRP_ICON_PV, SRP_ICON_UV,
                    OCB_MLF_READ_PV, OCB_MLF_READ_UV, OCB_CHKIN_READ_PV, OCB_CHKIN_READ_UV, SRP_OK_READ_PV, SRP_OK_READ_UV
                FROM  CAMPAIGN C, BLE_M_INTG_STA B
                WHERE C.MID = B.MID
                AND   B.STD_YM BETWEEN #{startDate} AND #{endDate}
                ORDER BY STD_DT, C.NAME1
            ) WHERE rownum &lt;= #{lastIndex}
        ) WHERE rnum > #{firstIndex}
    </select>
    <select id="getNewTechByMonthlyTotalForExcel" parameterType="JqGridRequest" resultType="BleNewTech">
        <include refid="selectMonthMid" />
        SELECT /*+ ORDERED INDEX(BLE_M_INTG_STA BLE_M_INTG_STA_NEW_PK) */ TO_CHAR(TO_DATE(B.STD_YM,'YYYYMM'),'YYYY-MM') AS STD_DT, C.NAME1, B.MID, OCB_SRP_PV, OCB_SRP_UV,
            OCB_COIN_PV, OCB_COIN_UV, OCB_LEAFLET_PV, OCB_LEAFLET_UV, SRP_PUSH_POP_PV, SRP_PUSH_POP_UV, SRP_PUSH_NOTI_PV, SRP_PUSH_NOTI_UV, SRP_ICON_BTN_PV, SRP_ICON_BTN_UV,
            OCB_MLF_CLK_PV, OCB_MLF_CLK_UV, OCB_CHKIN_CLK_PV, OCB_CHKIN_CLK_UV, SRP_OK_CLK_PV, SRP_OK_CLK_UV, SRP_CNCL_CLK_PV, SRP_CNCL_CLK_UV, SRP_ICON_BTN_CLK_PV, SRP_ICON_BTN_CLK_UV, SRP_ICON_PV, SRP_ICON_UV,
            OCB_MLF_READ_PV, OCB_MLF_READ_UV, OCB_CHKIN_READ_PV, OCB_CHKIN_READ_UV, SRP_OK_READ_PV, SRP_OK_READ_UV
        FROM  CAMPAIGN C, BLE_M_INTG_STA B
        WHERE C.MID = B.MID
        AND   B.STD_YM BETWEEN #{startDate} AND #{endDate}
        ORDER BY STD_DT, C.NAME1
    </select>
</mapper>
