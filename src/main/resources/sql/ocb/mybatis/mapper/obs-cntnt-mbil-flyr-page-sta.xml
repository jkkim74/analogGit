<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.skplanet.bisportal.repository.ocb.ObsCntntMbilFlyrPageStaRepository">

    <select id="getMobileFlyerPageInquiryPerDay" parameterType="JqGridRequest" resultType="ObsCntntMbilFlyrPageSta">
        SELECT TO_CHAR (TO_DATE (std_dt, 'YYYYMMDD'), 'YYYY-MM-DD') || '(' || TO_CHAR (TO_DATE (std_dt, 'YYYYMMDD'), 'dy') || ')' AS std_dt,
               PAGE_ID,
               ID,
               TITLE,
               <if test="measureCode != null and measureCode.equals('UV')">
                   NVL (INQ_CNT_ON_UV, 0) AS measureValue
               </if>
               <if test="measureCode != null and measureCode.equals('LV')">
                   NVL (INQ_CNT_ON_LV, 0) AS measureValue
               </if>
               <if test="measureCode != null and measureCode.equals('PV')">
                   NVL (INQ_CNT_ON_PV, 0) AS measureValue
               </if>
          FROM OBS_D_CNTNT_MBIL_FLYR_PAGE_STA
         WHERE std_dt between #{startDate} and #{endDate}
           AND poc_ind_cd = '01'
      ORDER BY page_id, id
    </select>
    <select id="getMobileFlyerPageInquiryPerWeek" parameterType="JqGridRequest" resultType="ObsCntntMbilFlyrPageSta">
        SELECT TO_CHAR (TO_DATE (std_dt, 'YYYYMMDD'), 'YYYY-MM-DD') || '(' || TO_CHAR (TO_DATE (std_dt, 'YYYYMMDD'), 'dy') || ')' AS std_dt,
               PAGE_ID,
               ID,
               TITLE,
               <if test="measureCode != null and measureCode.equals('UV')">
                   NVL (INQ_CNT_ON_UV, 0) AS measureValue
               </if>
               <if test="measureCode != null and measureCode.equals('LV')">
                   NVL (INQ_CNT_ON_LV, 0) AS measureValue
               </if>
               <if test="measureCode != null and measureCode.equals('PV')">
                   NVL (INQ_CNT_ON_PV, 0) AS measureValue
               </if>
          FROM OBS_W_CNTNT_MBIL_FLYR_PAGE_STA
         WHERE (std_dt <include refid="ObsCommonMapper.betweenStartDateAndEndDatePerWeek" />)
           AND poc_ind_cd = '01'
      ORDER BY page_id, id
    </select>
    <select id="getMobileFlyerPageInquiryPerMonth" parameterType="JqGridRequest" resultType="ObsCntntMbilFlyrPageSta">
        SELECT TO_CHAR (TO_DATE (std_ym, 'YYYYMM'), 'YYYY-MM') AS std_dt,
               PAGE_ID,
               ID,
               TITLE,
               <if test="measureCode != null and measureCode.equals('UV')">
                   NVL (INQ_CNT_ON_UV, 0) AS measureValue
               </if>
               <if test="measureCode != null and measureCode.equals('LV')">
                   NVL (INQ_CNT_ON_LV, 0) AS measureValue
               </if>
               <if test="measureCode != null and measureCode.equals('PV')">
                   NVL (INQ_CNT_ON_PV, 0) AS measureValue
               </if>
          FROM OBS_M_CNTNT_MBIL_FLYR_PAGE_STA
         WHERE std_ym between #{startDate} and #{endDate}
           AND poc_ind_cd = '01'
      ORDER BY page_id, id
    </select>
</mapper>
